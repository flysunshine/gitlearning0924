<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>js-task06</title>
	<style>
		button{
			border: 1px solid #ccc;
			border-radius: 2px;
			padding: 2px;
			font-size: 10px;
			font-weight: bold;
			margin-left: 10px;
			vertical-align: top;
		}
		input{
			vertical-align: top;
		}
		.eles{
			background-color: #ccc;
			margin: 5px 5px 0 0;
			display: inline-block;
			padding: 2px;
			font-size: 24px;
			color: #fff;
		}
	</style>
</head>
<body>
	<!-- <input id="val" type="text"> -->
	<textarea name="" id="val" cols="30" rows="5" placeholder="输入的内容可以为数字、中文、英文等，可以通过用回车，逗号，顿号，空格等符号作为不同内容的间隔"></textarea>
	<button>左侧入</button>
	<button>右侧入</button>
	<button>左侧出</button>
	<button>右侧出</button>
	<input type="text" id="query">
	<button>查询</button>
	<div id="container"></div>
	<script>
		var par = document.getElementById("container"),
			val = document.getElementById("val"),
			txtlist = null,
			query_txt = document.getElementById("query");
		// 创建元素，添加样式类，添加文本节点,分配点击事件
		function myele(S){
			var ele = document.createElement("p");
			ele.setAttribute("class","eles");
			ele.innerHTML = S;
			ele.onclick = function(){
				par.removeChild(this);
			}
			return ele;
		}
		// 左侧进入
		function left_in(t){
			if(t){
				for(i=0;i<txtlist.length;i++){
					par.insertBefore(myele(txtlist[i]),par.childNodes[0]);
				}
				// val.value = "";	
			}
		}
		// 右侧进入
		function right_in(t){
			if(t){
				for(i=0;i<txtlist.length;i++){
					par.appendChild(myele(txtlist[i]));
				}
				// val.value = "";	
			}
		}
		// 左侧出
		function left_out(){
			if(!par.childNodes.length) return false;
			alert(par.firstChild.innerHTML);
			par.removeChild(par.firstChild);
			val.value= "";
		}
		// 右侧出
		function right_out(){
			if(!par.childNodes.length) return false;
			alert(par.lastChild.innerHTML);
			par.removeChild(par.lastChild);
			val.value = "";
		}
		// 验证输入的值，验证通过返回字符串数组
		function ToF(){
			// 用正则验证，输入的内容可以为数字、中文、英文等，可以通过用回车，逗号（全角半角均可），顿号，空格（全角半角、Tab等均可）等符号作为不同内容的间隔
			var pattern1 = /[^0-9a-zA-Z\u4e00-\u9fa5\r,，、、\s]+/;
			if(val.value){
				if(!pattern1.test(val.value)){
					var pattern2 = /[0-9a-zA-Z\u4e00-\u9fa5]+/
					if(!pattern2.test(val.value)){
						alert("请输入数字、中文、英文等！");
						return false;
					}
					else{
						// 匹配字符串数组
						txtlist = val.value.toString().split(/[\r,，、、\s]+/);
						// 删除空字符串
						for(i=0;i<txtlist.length;i++){
							if(txtlist[i] == ""){
								txtlist.splice(i,1);
								i--;
							}
						}
						console.log(txtlist);
						return txtlist;
					}
				}
				else{
					alert("请输入数字、中文、英文等！");
					return false;
				}
			}
			else {
				alert("不能为空！");
				return false;
			}
		}
		// 查询后增加背景颜色
		function query(){
			for(i=0;i<par.children.length;i++){
				var str = query_txt.value;
				if(par.children[i].innerHTML.indexOf(str) >= 0){
					par.children[i].style.backgroundColor = "#00A2E8";
				}
				else{
					par.children[i].style.backgroundColor = "#ccc";
				}
			}
		};	
		// 为按钮添加点击事件
		function going(){
			var btn = document.getElementsByTagName("button");
			btn[0].onclick = function(){left_in(ToF())};
			btn[1].onclick = function(){right_in(ToF())};
			btn[2].onclick = function(){left_out()};
			btn[3].onclick = function(){right_out()};
			btn[4].onclick = function(){query()};
		};
		going();
	</script>
</body>
</html>